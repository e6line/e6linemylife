(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1876299d"],{c046:function(e,t,a){e.exports=a.p+"img/logo.aef5b502.jpg"},cc49:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mobild-layout"},[i("Layout",[i("Header",{staticStyle:{position:"fixed",width:"100%",background:"#fff",padding:"0 0","z-index":"1000","line-height":"0"}},[i("div",{staticStyle:{width:"95%",margin:"0 auto"}},[i("div",{staticClass:"layout-logo"},[i("a",{on:{click:function(t){e.backHome()}}},[i("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:a("c046"),align:"absmiddle"}})])]),e.loginFlag?i("Dropdown",{staticClass:"layout-nav",attrs:{trigger:"click"},on:{"on-click":function(t){e.dropdownClick(t)}}},[i("div",{staticClass:"avatar-badge-wrapper",attrs:{type:"success"}},[i("img",{staticStyle:{width:"40px",height:"40px","margin-top":"12px","border-radius":"100%"},attrs:{src:e.user.headimg}}),e.unreadMsgCount>0?i("span",{staticClass:"msg-num"},[e._v(e._s(e.unreadMsgCount))]):e._e()]),i("DropdownMenu",{staticClass:"dropdown-menu",attrs:{slot:"list"},slot:"list"},[i("DropdownItem",{attrs:{name:"name"}},[i("Icon",{attrs:{type:"ios-person"}}),e._v("\n                           \t"+e._s(e.user.name)+"\n                        ")],1),i("DropdownItem",{attrs:{name:"email",divided:""}},[i("Icon",{attrs:{type:"ios-mail"}}),e._v("\n                            邮件\n                        ")],1),i("DropdownItem",{attrs:{name:"messages",divided:""}},[i("Icon",{attrs:{type:"md-chatboxes"}}),e._v("\n                            消息\n                        ")],1),i("DropdownItem",{attrs:{name:"loginOut",divided:""}},[i("Icon",{attrs:{type:"md-log-out"}}),e._v("\n                        \t退出\n                        ")],1)],1)],1):e._e(),e.loginFlag?e._e():i("div",{staticClass:"layout-nav",staticStyle:{"margin-top":"14px"}},[i("Button",{attrs:{shape:"circle"},on:{click:function(t){e.toLogin()}}},[i("span",[e._v("登录")])])],1)],1)]),i("Content",{style:{margin:"80px 0 0 0",background:"#fff"}},[i("router-view")],1),i("Footer",{staticClass:"layout-footer-center"},[i("div",[i("a",{attrs:{href:"https://github.com/smallsnail-wh",target:"_blank"}},[i("Icon",{staticStyle:{color:"rebeccapurple"},attrs:{size:"40",type:"logo-github"}})],1)]),i("p",[e._v("2018-2020 © smallsail-wh")])])],1),i("Modal",{attrs:{"mask-closable":!1,visible:e.emailModal,loading:e.loading,title:"联系管理员"},on:{"update:visible":function(t){e.emailModal=t},"on-ok":function(t){e.emailOk("email")},"on-cancel":function(t){e.cancel()}},model:{value:e.emailModal,callback:function(t){e.emailModal=t},expression:"emailModal"}},[i("Form",{ref:"email",attrs:{rules:e.emailRule,model:e.email,"label-width":80}},[i("FormItem",{attrs:{label:"标题",prop:"title"}},[i("Input",{attrs:{placeholder:"请输入标题"},model:{value:e.email.title,callback:function(t){e.$set(e.email,"title",t)},expression:"email.title"}})],1),i("FormItem",{attrs:{label:"email",prop:"email"}},[i("Input",{attrs:{placeholder:"请输入email"},model:{value:e.email.email,callback:function(t){e.$set(e.email,"email",t)},expression:"email.email"}})],1),i("FormItem",{attrs:{label:"姓名",prop:"name"}},[i("Input",{attrs:{placeholder:"请输入姓名"},model:{value:e.email.name,callback:function(t){e.$set(e.email,"name",t)},expression:"email.name"}})],1),i("FormItem",{attrs:{label:"内容",prop:"content"}},[i("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"Enter something..."},model:{value:e.email.content,callback:function(t){e.$set(e.email,"content",t)},expression:"email.content"}})],1)],1)],1)],1)},s=[],o=(a("7f7f"),a("a481"),{data:function(){return{loginFlag:!1,consoleFlag:!1,loading:!0,searchValue:"",unreadMsgCount:0,emailModal:!1,email:{title:"",email:"",name:"",content:""},user:{loginName:"",email:"",headimg:"",name:""},emailRule:{title:[{type:"string",required:!0,message:"请输入密码",trigger:"blur"}],email:[{required:!0,message:"输入邮箱",trigger:"blur"},{type:"email",message:"输入正确的邮箱格式",trigger:"blur"}],passwordAgain:[{type:"string",required:!0,message:"请输入再次输入密码",trigger:"blur"}],name:[{type:"string",required:!0,message:"请输入姓名",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]}}},mounted:function(){this.$store.getters._isMobile||this.$router.replace("/");var e=this.$route.query.code,t=this.$route.query.state;this.login(e,t)},methods:{dropdownClick:function(e){"email"==e?this.emailModal=!0:"loginOut"==e?this.$store.dispatch("users/loginOUt",{router:this.$router}):"messages"==e&&this.$router.push({path:"/mobile/messages"})},toLogin:function(){this.$router.push("/mlogin")},userGet:function(){var e=this;this.axios({method:"get",url:"/public/getUserInfo"}).then(function(e){return null!=e.data.data&&""!=e.data.data?(this.loginFlag=!0,this.userSet(e.data.data),1==e.data.data.usertype&&(this.consoleFlag=!0),this.axios({method:"get",url:"/msgrecords/unreadnum"})):Promise.resolve(0)}.bind(this)).then(function(t){e.unreadMsgCount=0===t?t:t.data.data}).catch(function(e){this.$Message.error("无权限")}.bind(this))},userSet:function(e){this.user.loginName=e.loginName,this.user.email=e.email,this.user.headimg=e.headimg,this.user.name=e.name},search:function(){null!=this.searchValue&&""!=this.searchValue&&this.$router.push("/page/home/"+this.searchValue)},menuSelect:function(e){1==e||(2==e?this.emailModal=!0:3==e?this.$store.dispatch("users/loginOUt",{router:this.$router}):4==e?this.$router.push("/base"):5==e&&this.$router.push("/login"))},backHome:function(){this.$router.push("/page/home")},cancel:function(){this.$Message.info("点击了取消")},emailOk:function(e){var t=this;this.$refs[e].validate(function(e){e?(t.axios({method:"post",url:"/email",data:t.email}).then(function(e){this.$Message.info("发送成功")}.bind(t)).catch(function(e){alert(e)}),t.emailModal=!1):(t.$Message.error("表单验证失败!"),setTimeout(function(){t.loading=!1,t.$nextTick(function(){t.loading=!0})},1e3))})},login:function(e,t){var a=this;null!=e&&""!=e&&null!=t&&""!=t?(this.$Spin.show({render:function(e){return e("div",[e("Icon",{style:{animation:"ani-demo-spin 1s linear infinite"},props:{type:"load-c",size:18}}),e("div","正在登录，请等待...")])}}),setTimeout(function(){a.$Spin.hide()},1e4),"github"==t?this.githubLogin(e):"qq"==t?this.qqLogin(e):(this.$router.push({path:"/"}),location.reload())):this.userGet()},githubLogin:function(e){this.axios({method:"post",url:"/authentication/github",params:{code:e},auth:{username:"client",password:"secret"}}).then(function(e){localStorage.setItem("currentUser_token",e.data.access_token),localStorage.setItem("currentUser_refresh_token",e.data.refresh_token),this.axios.defaults.headers.common["Authorization"]="bearer "+localStorage.getItem("currentUser_token"),this.$router.push({path:"/"}),location.reload()}.bind(this)).catch(function(e){this.$Message.error("登陆失败")}.bind(this))},qqLogin:function(e){this.axios({method:"post",url:"/authentication/qq",params:{code:e},auth:{username:"client",password:"secret"}}).then(function(e){localStorage.setItem("currentUser_token",e.data.access_token),localStorage.setItem("currentUser_refresh_token",e.data.refresh_token),this.axios.defaults.headers.common["Authorization"]="bearer "+localStorage.getItem("currentUser_token"),this.$router.push({path:"/"}),location.reload()}.bind(this)).catch(function(e){this.$Message.error("登陆失败")}.bind(this))},toMessages:function(){this.$router.push({path:"/page/messages"})}}}),n=o,r=(a("e0f7"),a("2877")),l=Object(r["a"])(n,i,s,!1,null,"3e8edf92",null);l.options.__file="index.vue";t["default"]=l.exports},d9fb:function(e,t,a){},e0f7:function(e,t,a){"use strict";var i=a("d9fb"),s=a.n(i);s.a}}]);
//# sourceMappingURL=chunk-1876299d.7481d7f5.js.map